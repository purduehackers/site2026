---
import '../styles/global.css';

interface Props {
	title?: string;
}

const { title = 'Purdue Hackers' } = Astro.props;
---
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/icon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />

		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
		href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200..900&display=swap"
		rel="stylesheet"
		/>

		<title>{title}</title>
		<style is:global>
			.header-over-dark .nav-link { color: #fff !important; }
			.header-over-dark .nav-link:hover {
				background: #fff !important;
				color: #7D3BFF !important;
			}
		</style>
	</head>
	<body>
		<header id="site-header" class="fixed top-0 right-0 z-10 px-8 py-6 font-inconsolata header-links">
			<nav class="flex gap-8">
				<a href="https://blog.purduehackers.com/" class="nav-link text-sm text-black tracking-wide font-semibold">BLOG</a>
				<a href="https://events.purduehackers.com/" class="nav-link text-sm text-black tracking-wide font-semibold">EVENTS</a>
				<a href="https://drops.purduehackers.com/" class="nav-link text-sm text-black tracking-wide font-semibold">MERCH</a>
				<a href="https://grants.purduehackers.com/" class="nav-link text-sm text-black tracking-wide font-semibold">MICROGRANTS</a>
			</nav>
		</header>
		<slot />
		<script>
			const header = document.getElementById('site-header');
			const darkSection = document.querySelector('[data-header-dark]');
			if (header && darkSection) {
				function updateHeader() {
					if (!darkSection) return;
					if (!header) return;
					const rect = darkSection.getBoundingClientRect();
					header.classList.toggle('header-over-dark', rect.top <= 80);
				}
				window.addEventListener('scroll', updateHeader, { passive: true });
				updateHeader();
			}

			let lastHackNightScroll = 0;
			function scrollToHackNight() {
				const el = document.getElementById('hack-night');
				if (el) {
					el.scrollIntoView({ behavior: 'smooth', block: 'center' });
					lastHackNightScroll = Date.now();
				}
			}

			document.addEventListener('click', (e: MouseEvent) => {
				if (!(e.target as HTMLElement | null)?.closest?.('a[href="#hack-night"]')) return;
				e.preventDefault();
				if (Date.now() - lastHackNightScroll < 500) return; // avoid double scroll on mobile
				scrollToHackNight();
			}, true);

			document.addEventListener('touchend', (e: TouchEvent) => {
				if (!(e.target as HTMLElement | null)?.closest?.('a[href="#hack-night"]')) return;
				e.preventDefault();
				scrollToHackNight();
			}, { passive: false });
		</script>
	</body>
</html>
